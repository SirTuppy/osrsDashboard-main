<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSRS Progress Dashboard</title>
    <!-- Link Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="dashboard">
        <!-- Page Header -->
        <header class="page-header container">
            <div class="stats-header">
                <div class="stats-header-content">
                    <!-- Top Row: Left Info, Title, Right Actions -->
                    <div class="header-top-row">
                        <div class="header-left-info">
                            <div class="username" id="player-name" contenteditable="true" title="Click to edit username, press Enter to fetch">Enter Username</div>
                            <div id="combat-level-display">Combat Level: --</div>
                        </div>
                        <div class="header-title-row">
                            <h1>OSRS Progress Dashboard</h1>
                        </div>
                        <div class="header-actions">
                           <button id="fetch-hiscores-button" class="filter-button" title="Fetch current stats from OSRS Hiscores">Fetch Stats</button>
                           <input type="file" id="import-file-input" accept=".json" style="display: none;">
                           <button id="import-data-button" class="filter-button" title="Import saved dashboard data (.json)">Import</button>
                           <button id="export-data-button" class="filter-button" title="Export current dashboard data (.json)">Export</button>
                           <!-- Dark Mode Toggle -->
                           <button id="theme-toggle-button" class="filter-button">ðŸŒ™</button>
                       </div>
                    </div>

                    <!-- Bottom Row: Navigation Tabs -->
                    <nav class="view-navigation header-view-navigation">
                        <button class="filter-button active-view" data-view="dashboard-view">Dashboard</button>
                        <button class="filter-button" data-view="diaries-view">Diaries</button>
                        <button class="filter-button" data-view="goals-view">Milestone Goals</button>
                        <button class="filter-button" data-view="gear-view">Gear Progression</button>
                        <button class="filter-button" data-view="combat-tasks-view">Combat Tasks</button>
                        <button class="filter-button" data-view="quests-view">Quests</button> <!-- <<< ADDED QUESTS BUTTON -->
                    </nav>
                </div> <!-- End of stats-header-content -->
            </div>

            <div class="overall-stats">
                <!-- Overall stats populated by JS -->
                 <div>Diary Tasks: <span id="elite-completed">0</span>/<span id="elite-total">0</span></div>
                 <div>Overall Diary: <span id="overall-progress">0</span>%</div>
                 <div>Levels Needed: <span id="total-levels-needed">0</span></div>
                 <div>XP Needed: <span id="total-xp-needed">0</span></div>
                 <div class="time-remaining">Est. Time: <span id="total-time">0</span> hrs</div>
            </div>
        </header> <!-- End of .page-header -->

        <!-- Main Content Area -->
        <main>
            <!-- Dashboard View (Default Visible) -->
            <div id="dashboard-view">
                <div class="flex-row">
                    <!-- Wrapper for the LEFT column (Summary + Misc Goals) -->
                    <div class="dashboard-left-column">
                        <!-- Dashboard Summary Section -->
                        <section id="dashboard-summary-section" class="container">
                            <h4>Milestone Progression</h4>
                            <div class="summary-category" id="summary-milestones"></div>
                            <h4>Gear Progression</h4>
                            <div class="summary-category" id="summary-gear"></div>
                            <h4>Achievement Diary Progression</h4>
                            <div class="summary-category" id="summary-diaries"></div>
                            <h4>Combat Achievement Progression</h4>
                            <div class="summary-category" id="summary-combat-tasks"></div>
                        </section>
                        <!-- END Dashboard Summary Section -->

                        <!-- Miscellaneous Goals -->
                        <section class="miscellaneous-goals-container container">
                             <div class="stats-header">
                                 <div>Miscellaneous Goals</div>
                                 <button id="add-goal-button" class="filter-button">Add Goal</button>
                             </div>
                             <div class="miscellaneous-goals-content" id="miscellaneous-goals"></div>
                         </section>
                        <!-- END Miscellaneous Goals -->
                    </div> <!-- END Wrapper for the left column -->

                    <!-- Wrapper for the RIGHT column (Skill Summary) -->
                    <div class="dashboard-right-column">
                        <!-- Skill Requirements Summary -->
                        <section class="summary-card container">
                             <div class="stats-header">
                                 <div>Skill Requirements Summary <span id="custom-rates-indicator" class="summary-title-indicator" style="display: none;">(Using Custom Rates)</span></div>
                                 <button id="edit-skills-button" class="filter-button">Edit Skills</button>
                             </div>
                             <div class="sort-buttons">
                                 <button class="filter-button" data-sort="name">Sort by Name</button>
                                 <button class="filter-button active" data-sort="level">Sort by Level Needed</button>
                                 <button class="filter-button" data-sort="hours">Sort by Time</button>
                             </div>
                             <div class="summary-content" id="skill-summary"></div>
                         </section>
                        <!-- END Skill Requirements Summary -->
                    </div> <!-- End Right Column -->
                </div> <!-- End Flex Row -->
            </div> <!-- End of #dashboard-view -->

            <!-- Achievement Diaries View (Hidden by default) -->
            <div id="diaries-view" class="view-hidden">
                <h2>Achievement Diaries</h2>
                <section class="diaries-grid"></section>
            </div> <!-- End of #diaries-view -->

            <!-- Milestone Goals View (Hidden by default) -->
            <div id="goals-view" class="view-hidden">
                <h2>Milestone Goals</h2>
                <section id="cumulative-goal-tracker" class="container cumulative-tracker">
                    <div class="goal-tier-header">
                        <h3 style="color: var(--text-accent);">Overall Milestone Progress</h3>
                        <div class="goal-progress-container">
                            <div id="cumulative-progress-bar" class="goal-progress-bar" style="background-color: var(--accent-gold);"></div>
                        </div>
                        <span id="cumulative-percentage" class="goal-percentage">0%</span>
                    </div>
                </section>
                <section class="goals-grid"></section>
            </div> <!-- End of #goals-view -->

            <!-- Gear Progression View (Hidden by default) -->
            <div id="gear-view" class="view-hidden">
                <h2>Gear Progression</h2>
                <section id="cumulative-gear-tracker" class="container cumulative-tracker">
                   <div class="gear-stage-header">
                        <h3 style="color: var(--text-accent);">Overall Gear Cost</h3>
                         <div class="goal-progress-container">
                            <div id="cumulative-gear-progress-bar" class="goal-progress-bar" style="background-color: var(--accent-green-muted);"></div>
                        </div>
                        <span id="cumulative-gear-percentage" class="goal-percentage">0%</span>
                   </div>
                </section>
                <section class="gear-stages-grid"></section>
            </div> <!-- End of #gear-view -->

            <!-- Combat Achievements View (Hidden by default) -->
            <div id="combat-tasks-view" class="view-hidden">
                <h2>Combat Achievements</h2>
                <section id="cumulative-ca-tracker" class="container cumulative-tracker">
                    <div class="goal-tier-header">
                        <h3 style="color: var(--text-accent);">Overall Progress</h3>
                         <span class="ca-points-display">Points: <span id="ca-total-points">0</span></span>
                         <span class="ca-tier-display">Current Tier: <span id="ca-current-tier">None</span></span>
                         <div class="goal-progress-container">
                             <div id="cumulative-ca-progress-bar" class="goal-progress-bar" style="background-color: var(--accent-grey-muted);"></div>
                         </div>
                         <span id="cumulative-ca-percentage" class="goal-percentage">0%</span>
                    </div>
                </section>
                <section class="ca-filters container">
                    <h4>Filters</h4>
                    <div class="filter-row">
                        <label>Tiers:</label>
                        <div class="filter-options" id="ca-tier-filters">
                            <button class="filter-button active" data-filter-type="tier" data-filter-value="all">All</button>
                            <button class="filter-button" data-filter-type="tier" data-filter-value="easy">Easy</button>
                            <button class="filter-button" data-filter-type="tier" data-filter-value="medium">Med</button>
                            <button class="filter-button" data-filter-type="tier" data-filter-value="hard">Hard</button>
                            <button class="filter-button" data-filter-type="tier" data-filter-value="elite">Elite</button>
                            <button class="filter-button" data-filter-type="tier" data-filter-value="master">Master</button>
                            <button class="filter-button" data-filter-type="tier" data-filter-value="grandmaster">GM</button>
                        </div>
                    </div>
                     <div class="filter-row">
                         <label>Types:</label>
                         <div class="filter-options" id="ca-type-filters">
                             <button class="filter-button active" data-filter-type="type" data-filter-value="all">All</button>
                             <button class="filter-button" data-filter-type="type" data-filter-value="Kill Count">KC</button>
                             <button class="filter-button" data-filter-type="type" data-filter-value="Mechanical">Mech</button>
                             <button class="filter-button" data-filter-type="type" data-filter-value="Perfection">Perf</button>
                             <button class="filter-button" data-filter-type="type" data-filter-value="Restriction">Res</button>
                             <button class="filter-button" data-filter-type="type" data-filter-value="Speed">Speed</button>
                             <button class="filter-button" data-filter-type="type" data-filter-value="Stamina">Stam</button>
                         </div>
                     </div>
                    <div class="filter-row">
                        <label>Status:</label>
                        <div class="filter-options" id="ca-status-filters">
                            <button class="filter-button active" data-filter-type="status" data-filter-value="all">All</button>
                            <button class="filter-button" data-filter-type="status" data-filter-value="incomplete">Incomplete</button>
                            <button class="filter-button" data-filter-type="status" data-filter-value="completed">Completed</button>
                        </div>
                    </div>
                     <div class="filter-row">
                         <label for="ca-boss-search">Boss Search:</label>
                         <input type="text" id="ca-boss-search" placeholder="Filter by boss/task name...">
                     </div>
                </section>
                <section class="combat-tasks-grid"></section>
            </div> <!-- End of #combat-tasks-view -->

            <!-- Quest Milestones View (Hidden by default) <<< ADDED QUESTS VIEW -->
            <div id="quests-view" class="view-hidden">
                <!-- Content will be populated by ui.js -> populateQuestsView -->
                <!-- Example Structure added by JS:
                <h2>Quest Milestones</h2>
                <section class="quests-grid container">
                    <section class="quest-section">
                        <h3>Notable Unlocks</h3>
                        <div class="tasks quest-list">
                            <div class="task quest-milestone">
                                <input type="checkbox" class="quest-checkbox" id="quest-Druidic-Ritual" data-quest-name="Druidic Ritual">
                                <label class="task-description" for="quest-Druidic-Ritual">Druidic Ritual</label>
                                <span class="goal-info">(Herblore)</span>
                            </div>
                            ...
                        </div>
                    </section>
                    <section class="quest-section">
                         <h3>Major Milestones</h3>
                         <div class="tasks quest-list">...</div>
                    </section>
                </section>
                -->
            </div> <!-- End of #quests-view -->

        </main> <!-- End of Main Content Area -->

    </div> <!-- End of .dashboard -->

    <!-- Skill Editor Modal (Global) -->
    <div id="skill-editor-modal" class="modal">
        <div class="modal-content container">
            <span class="modal-close" onclick="closeSkillEditor()" title="Close Editor">Ã—</span>
            <h3>Edit Skill Levels & XP Rates</h3>
            <div class="skill-editor" id="skill-editor-container"></div>
            <div class="modal-actions">
                <button class="filter-button" id="reset-skills">Reset to Default</button>
                <button class="save-button" id="save-skills">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Load JavaScript Module -->
    <script type="module" src="app.js"></script>
</body>
</html>