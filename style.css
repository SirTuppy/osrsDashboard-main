/* --- Global Styles & Variables (Ancient Tome Theme) --- */
:root {
    /* --- Light/Default Tome Theme --- */
    --bg-parchment: #f5eeda;
    --bg-tan-light: #d2b48c;         /* Lighter background for elements */
    --bg-tan-medium: #c1a98b;        /* Slightly darker bg, often for headers/buttons */
    --bg-brown-dark: #5a3d2b;         /* Dark text or accents */
    --bg-brown-deep: #3e2c1d;         /* Very dark text or backgrounds */

    --border-dark: #654321;           /* Darkest border */
    --border-medium: #8b4513;        /* Medium border, often hover */
    --border-light: #a0522d;         /* Lighter border for contrast */

    --text-primary: #3a2a1a;          /* Main dark text */
    --text-secondary: #6b4f34;        /* Lighter secondary text */
    --text-accent: #800000;           /* Maroon for main headings/accents */
    --text-on-dark: #e0d6c1;          /* Light text for dark backgrounds */
    --text-link: #50387d;             /* Muted Purple for links */
    --text-link-hover: #800000;       /* Maroon on hover */

    --accent-gold: #daa520;           /* Main gold accent */
    --accent-gold-dark: #b8860b;      /* Darker gold */
    --accent-red-deep: #8b0000;       /* Deep red for hard/not met */
    --accent-green-muted: #556b2f;    /* Muted green for met/completed */
    --accent-purple-muted: #6a4f6d;
    --accent-blue-muted: #465d7a;
    --accent-grey-muted: #696969;
    --accent-indigo-muted: #4b0082;
    --accent-dark-green: #006400;
    --accent-yellow-green: #9acd32;
    --accent-blue-active: #3b82f6; /* Keep a standard blue for active elements */

    /* --- Dark Tome Theme Variables --- */
    --dm-bg-darkest: #1f1a15;
    --dm-bg-dark: #2e251d;
    --dm-bg-medium: #40352a;
    --dm-bg-light: #524538;

    --dm-border-light: #5a4a3b;
    --dm-border-medium: #40352a;
    --dm-border-dark: #2e251d; /* Added dark border for dark mode */

    --dm-text-primary: #e4d8c8;
    --dm-text-secondary: #a89986;
    --dm-text-accent: #ffb3b3;
    --dm-text-on-light: #1f1a15; /* Dark text for light elements like gold buttons */
    --dm-text-link: #ad9bf0;
    --dm-text-link-hover: #ffb3b3;

    --dm-accent-gold: #f0c454;
    --dm-accent-gold-dark: #daa520;
    --dm-accent-red-deep: #ff8080;
    --dm-accent-green-muted: #8fbc8f;
    --dm-accent-purple-muted: #ab8fbb;
    --dm-accent-blue-muted: #87a0c0;
    --dm-accent-grey-muted: #9e9e9e;
    --dm-accent-indigo-muted: #7f63b3;
    --dm-accent-dark-green: #57a657;
    --dm-accent-yellow-green: #bada55;
    --dm-accent-blue-active: #7aa2f7; /* Lighter blue for dark mode active */


    /* Font Variables */
    --font-heading: 'Cinzel', serif;
    --font-body: 'EB Garamond', serif;

    /* Transitions */
    --transition-speed: 0.3s;
    --transition-func: ease;
}

/* Basic Reset & Body */
*, *::before, *::after { box-sizing: border-box; } /* Keep margin/padding reset minimal */

body {
    font-family: var(--font-body);
    font-size: 16px;
    line-height: 1.6;
    color: var(--text-primary);
    background-color: var(--bg-parchment);
    background-image: linear-gradient(rgba(193, 169, 139, 0.08) 1px, transparent 1px),
                      linear-gradient(90deg, rgba(193, 169, 139, 0.08) 1px, transparent 1px);
    background-size: 30px 30px;
    max-width: 1400px; /* Slightly wider */
    margin: 20px auto;
    padding: 20px;
    min-height: 100vh;
    transition: background-color var(--transition-speed) var(--transition-func),
                color var(--transition-speed) var(--transition-func);
}

body.dark-mode {
    color: var(--dm-text-primary);
    background-color: var(--dm-bg-darkest);
    background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                      linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
    background-size: 40px 40px;
}

/* Headings */
h1, h2, h3, h4 {
    font-family: var(--font-heading);
    color: var(--text-accent);
    font-weight: 600;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    margin: 0 0 0.75em 0; /* Reset default margins, add consistent bottom */
    padding: 0;
    transition: color var(--transition-speed) var(--transition-func);
}
h1 {
    font-size: 1.8em; color: var(--text-primary); line-height: 1.2; font-weight: 700; margin-bottom: 0;
}
h2 { text-align: center; margin-bottom: 30px; font-size: 2.2em; }
h3 { font-size: 1.4em; margin-bottom: 0; } /* Removed bottom margin, handled by parent gap/padding */
h4 {
    font-size: 1.2em; border-bottom: 1px solid var(--border-medium); padding-bottom: 5px; color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
/* Dark Mode Headings */
body.dark-mode h1, body.dark-mode h4 { color: var(--dm-text-primary); }
body.dark-mode h2, body.dark-mode h3 { color: var(--dm-text-accent); }
body.dark-mode h4 { border-bottom-color: var(--dm-border-light); }

/* Links (Keep original simple style) */
a { color: var(--text-link); text-decoration: none; transition: color 0.2s ease; }
a:hover { color: var(--text-link-hover); text-decoration: underline; }
body.dark-mode a { color: var(--dm-text-link); }
body.dark-mode a:hover { color: var(--dm-text-link-hover); }

/* --- Layout Containers --- */
.dashboard { display: flex; flex-direction: column; gap: 30px; }
.container {
    background-color: rgba(210, 180, 140, 0.85);
    border: 2px solid var(--border-dark);
    border-radius: 5px;
    padding: 20px;
    box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.2), inset 0 0 10px rgba(0,0,0,0.05);
    transition: background-color var(--transition-speed) var(--transition-func),
                border-color var(--transition-speed) var(--transition-func),
                box-shadow var(--transition-speed) var(--transition-func);
}
body.dark-mode .container {
    background-color: rgba(46, 37, 29, 0.85);
    border: 2px solid var(--dm-border-light);
    box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.3), inset 0 0 10px rgba(255,255,255,0.03);
}
.flex-row { display: flex; gap: 30px; flex-wrap: wrap; }
.flex-column { display: flex; flex-direction: column; gap: 30px; }

/* --- Player Header --- */
/* Re-integrate original detailed styles with theme variables */
.player-info { padding: 0; margin-bottom: 0; }
.stats-header {
    padding: 15px 20px 10px 20px;
    background-color: var(--bg-tan-medium);
    border-radius: 5px 5px 0 0;
    border-bottom: 2px solid var(--border-dark);
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); /* Keep subtle shadow */
    transition: background-color var(--transition-speed) var(--transition-func),
                border-color var(--transition-speed) var(--transition-func),
                box-shadow var(--transition-speed) var(--transition-func);
}
body.dark-mode .stats-header {
    background-color: var(--dm-bg-medium);
    border-bottom-color: var(--dm-border-light);
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
}
.stats-header-content { display: flex; flex-direction: column; gap: 15px; }
.header-top-row { display: flex; justify-content: space-between; align-items: flex-start; gap: 20px; }
.header-left-info { display: flex; flex-direction: column; align-items: flex-start; flex-shrink: 0; }
.header-left-info .username {
    font-family: var(--font-heading); font-size: 2em; font-weight: 700; line-height: 1.1; margin-bottom: 2px;
    color: var(--text-primary); text-shadow: 1px 1px 2px rgba(255,255,255,0.2); /* Keep subtle shadow */
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .header-left-info .username { color: var(--dm-text-primary); text-shadow: 1px 1px 2px rgba(0,0,0,0.3); }
.header-left-info #combat-level-display {
    font-size: 1.1em; font-weight: 600; color: var(--accent-gold-dark); margin-bottom: 0; font-family: var(--font-body);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .header-left-info #combat-level-display { color: var(--dm-accent-gold); }

.header-title-row { text-align: center; flex-grow: 1; padding-top: 8px; }
.header-actions { display: flex; gap: 10px; align-items: center; flex-shrink: 0; }
.header-actions .filter-button { /* Uses button styles */ padding: 6px 12px; font-size: 0.9em; }

/* Header Navigation */
.header-view-navigation {
    display: flex; gap: 10px; justify-content: center; padding-top: 10px;
    border-top: 1px solid var(--border-medium); margin-top: 10px;
    transition: border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .header-view-navigation { border-top-color: var(--dm-border-medium); }
.header-view-navigation .filter-button {
    /* Uses base button style, specific overrides below */
    padding: 7px 14px; font-size: 0.9em;
    background-color: rgba(0,0,0, 0.05); /* Light mode slight overlay */
    border: 1px solid var(--border-medium); /* Match border */
    color: var(--text-primary);
}
body.dark-mode .header-view-navigation .filter-button {
    background-color: rgba(255,255,255, 0.05); /* Dark mode slight overlay */
    border-color: var(--dm-border-medium);
    color: var(--dm-text-primary);
}
.header-view-navigation .filter-button:hover {
    background-color: rgba(0,0,0, 0.1);
    border-color: var(--border-dark); /* Darker border on hover */
}
body.dark-mode .header-view-navigation .filter-button:hover {
    background-color: rgba(255,255,255, 0.1);
    border-color: var(--dm-border-light); /* Lighter border on hover */
}
.header-view-navigation .filter-button.active-view {
    background-color: var(--accent-gold); border-color: var(--accent-gold-dark);
    color: var(--bg-brown-deep); font-weight: 700; box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
}
body.dark-mode .header-view-navigation .filter-button.active-view {
    background-color: var(--dm-accent-gold); border-color: var(--dm-accent-gold-dark);
    color: var(--dm-text-on-light); box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
}

/* Username Editing */
.username[contenteditable="true"] { /* Original styles restored */
    cursor: text; padding: 2px 5px; border-radius: 4px; outline: none;
    border: 1px dashed transparent; transition: border-color 0.2s ease, background-color 0.2s ease;
}
.username[contenteditable="true"]:hover,
.username[contenteditable="true"]:focus {
    background-color: rgba(0, 0, 0, 0.05); border-color: var(--border-medium);
}
body.dark-mode .username[contenteditable="true"]:hover,
body.dark-mode .username[contenteditable="true"]:focus {
    background-color: rgba(255, 255, 255, 0.08); border-color: var(--dm-border-medium);
}

/* Overall Stats Bar */
.overall-stats { /* Original styles restored with theme vars */
    display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px 20px;
    padding: 15px 20px; background-color: var(--bg-tan-light); border: none;
    border-top: 1px solid var(--border-medium); border-radius: 0 0 5px 5px;
    box-shadow: inset 0 -2px 5px rgba(0,0,0,0.08);
    transition: background-color var(--transition-speed) var(--transition-func),
                border-color var(--transition-speed) var(--transition-func),
                box-shadow var(--transition-speed) var(--transition-func);
}
body.dark-mode .overall-stats {
    background-color: var(--dm-bg-dark); border-top-color: var(--dm-border-medium);
    box-shadow: inset 0 -2px 5px rgba(0,0,0,0.15);
}
.overall-stats div { font-size: 1em; color: var(--text-primary); transition: color var(--transition-speed) var(--transition-func); }
body.dark-mode .overall-stats div { color: var(--dm-text-primary); }
.overall-stats span { font-weight: 600; color: var(--accent-gold-dark); transition: color var(--transition-speed) var(--transition-func); }
body.dark-mode .overall-stats span { color: var(--dm-accent-gold); }

/* --- Dashboard View Layout --- */
#dashboard-view .dashboard-left-column { flex: 1; min-width: 300px; gap: 30px; display: flex; flex-direction: column;}
#dashboard-view .dashboard-right-column { flex: 2; min-width: 450px; gap: 30px; display: flex; flex-direction: column;}

/* Dashboard Summary Section */
#dashboard-summary-section h4 { /* Original styles restored with theme vars */
    margin-top: 15px; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px solid var(--border-medium);
    font-size: 1.1em; color: var(--text-secondary); font-family: var(--font-heading);
    transition: color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
#dashboard-summary-section h4:first-of-type { margin-top: 0; }
body.dark-mode #dashboard-summary-section h4 { color: var(--dm-text-secondary); border-bottom-color: var(--dm-border-medium); }
.summary-category { padding: 5px 0; }
.summary-progress-row { display: flex; align-items: center; margin-bottom: 8px; gap: 10px; }
.summary-label { /* Original styles restored with theme vars */
    width: 80px; font-size: 0.95em; flex-shrink: 0; color: var(--text-primary); overflow: hidden;
    white-space: nowrap; text-overflow: ellipsis; transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .summary-label { color: var(--dm-text-primary); }
.summary-bar-container { /* Original detailed styles restored with theme vars */
    flex-grow: 1; height: 16px; background-color: var(--bg-brown-deep); border-radius: 3px; overflow: hidden;
    border: 1px solid var(--border-dark); box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .summary-bar-container {
    background-color: var(--dm-bg-darkest); border-color: var(--dm-border-medium); box-shadow: inset 0 1px 2px rgba(0,0,0,0.5);
}
.summary-bar { height: 100%; border-radius: 2px; transition: width 0.4s ease-out, background-color var(--transition-speed) var(--transition-func); }
.summary-percentage { /* Original styles restored with theme vars */
    width: 40px; font-size: 0.95em; font-weight: 600; text-align: right; flex-shrink: 0; color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .summary-percentage { color: var(--dm-text-primary); }

/* Skill Summary Card */
/* Uses .container styles */
.summary-card .stats-header { /* Original detailed styles restored with theme vars */
    display: flex; justify-content: space-between; align-items: center; padding: 12px 15px;
    border-radius: 5px 5px 0 0; border-bottom: 2px solid var(--border-dark); background-color: var(--bg-tan-medium);
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func), box-shadow var(--transition-speed) var(--transition-func);
}
body.dark-mode .summary-card .stats-header {
    background-color: var(--dm-bg-medium); border-bottom-color: var(--dm-border-light); box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
}
.summary-card .stats-header div { /* Original detailed styles restored with theme vars */
    font-weight: 600; color: var(--text-primary); font-family: var(--font-heading); font-size: 1.1em;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .summary-card .stats-header div { color: var(--dm-text-primary); }
.summary-content { padding: 0 15px 15px 15px; }
.sort-buttons { /* Original detailed styles restored with theme vars */
    display: flex; gap: 10px; margin-bottom: 15px; padding: 10px 0; border-bottom: 1px solid var(--border-medium);
    transition: border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .sort-buttons { border-bottom-color: var(--dm-border-medium); }

/* Skill Row Items */
/* Re-apply original styles with theme vars + layout fix */
.skill-progress { display: flex; align-items: center; margin-bottom: 10px; padding: 5px 0; }
.skill-name { /* Original styles restored with theme vars */
    width: 110px; flex-shrink: 0; font-weight: 500; font-size: 1.05em; color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .skill-name { color: var(--dm-text-primary); }
.skill-level { /* Original styles restored with theme vars */
    width: 90px; flex-shrink: 0; text-align: center; font-size: 1em; color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .skill-level { color: var(--dm-text-primary); }
.editable-level { /* Original styles restored with theme vars */
    cursor: pointer; padding: 2px 6px; border-radius: 4px; display: inline-block;
    transition: background-color 0.2s ease; font-weight: 600;
}
.editable-level:hover { background-color: rgba(0,0,0,0.1); }
body.dark-mode .editable-level:hover { background-color: rgba(255,255,255,0.15); }
.required-level-indicator { /* Original styles restored with theme vars */
    margin-left: 3px; font-size: 0.85em; color: var(--accent-gold-dark); font-weight: 600; cursor: default;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .required-level-indicator { color: var(--dm-accent-gold); }
.skill-progress-container { /* Original detailed styles restored with theme vars */
    flex-grow: 1; background-color: var(--bg-brown-deep); height: 18px; border-radius: 3px; overflow: hidden;
    position: relative; margin: 0 12px; border: 1px solid var(--border-dark); box-shadow: inset 0 1px 3px rgba(0,0,0,0.4);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func), box-shadow var(--transition-speed) var(--transition-func);
}
body.dark-mode .skill-progress-container {
    background-color: var(--dm-bg-darkest); border-color: var(--dm-border-medium); box-shadow: inset 0 1px 3px rgba(0,0,0,0.5);
}
.skill-progress-bar { /* Original detailed styles restored with theme vars */
    height: 100%; background-color: var(--accent-green-muted); border-radius: 2px;
    transition: width 0.3s ease, background-color var(--transition-speed) var(--transition-func);
    background-image: linear-gradient(to right, var(--accent-green-muted), #7a9a4a); /* Example gradient */
}
body.dark-mode .skill-progress-bar {
    background-color: var(--dm-accent-green-muted);
    background-image: linear-gradient(to right, var(--dm-accent-green-muted), #a8d1a8);
}
.xp-info { /* Original styles restored with theme vars */
    position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--text-on-dark);
    font-size: 0.8em; font-weight: 500; text-shadow: 1px 1px 1px rgba(0,0,0,0.7); z-index: 1; pointer-events: none;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .xp-info { color: var(--dm-text-on-light); text-shadow: 1px 1px 1px rgba(255,255,255,0.3); }
.completed-indicator { /* Original styles restored with theme vars */
    font-size: 1.1em; margin-left: auto; flex-shrink: 0; width: 25px; text-align: center;
    color: var(--accent-green-muted); font-weight: bold; transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .completed-indicator { color: var(--dm-accent-green-muted); }
.training-time { /* Original styles restored with theme vars */
    margin-left: 10px; /* Consistent small gap */ padding-left: 0; /* Remove extra padding */
    color: var(--text-secondary); font-size: 0.9em; width: 70px; text-align: right; flex-shrink: 0;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .training-time { color: var(--dm-text-secondary); }
.summary-title-indicator { /* Original styles restored with theme vars */
    font-size: 0.85em; color: var(--text-secondary); margin-left: 10px; font-style: italic;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .summary-title-indicator { color: var(--dm-text-secondary); }
.skill-name.clickable { /* Original styles restored with theme vars */
    cursor: pointer; text-decoration: underline dotted; text-decoration-color: var(--text-secondary);
    transition: color 0.2s ease, text-decoration-color 0.2s ease;
}
body.dark-mode .skill-name.clickable { text-decoration-color: var(--dm-text-secondary); }
.skill-name.clickable:hover, .skill-name.clickable.active { color: var(--text-link); text-decoration-color: var(--text-link); }
body.dark-mode .skill-name.clickable:hover, body.dark-mode .skill-name.clickable.active { color: var(--dm-text-link); text-decoration-color: var(--dm-text-link); }


/* --- Diaries View --- */
#diaries-view .diaries-grid { /* Original layout styles restored */
    display: grid; grid-template-columns: 1fr; gap: 25px; padding: 10px 0;
}
@media (min-width: 1200px) {
    #diaries-view .diaries-grid { grid-template-columns: repeat(2, 1fr); align-items: start; }
}
#diaries-view .diary-card { /* Uses .container styles */ margin-bottom: 0; border-radius: 5px; overflow: hidden; }
body.dark-mode #diaries-view .diary-card { /* Uses .dark-mode .container */ }

/* Diary Card Items */
.diary-header { /* Original detailed styles restored with theme vars */
    display: flex; flex-direction: column; padding: 12px 15px; cursor: pointer;
    background-color: rgba(0,0,0,0.03); border-bottom: 1px solid var(--border-medium);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
.diary-header:hover { background-color: rgba(0,0,0,0.07); }
body.dark-mode .diary-header { background-color: rgba(255,255,255,0.03); border-bottom-color: var(--dm-border-medium); }
body.dark-mode .diary-header:hover { background-color: rgba(255,255,255,0.07); }
.diary-title-row { /* Original styles restored */ display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; width: 100%; }
.diary-name { /* Original styles restored with theme vars */
    text-align: left; font-weight: 700; font-size: 1.2em; font-family: var(--font-heading); color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .diary-name { color: var(--dm-text-primary); }
.diary-progress { /* Original styles restored with theme vars */
    text-align: right; display: flex; align-items: center; font-weight: 500; color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .diary-progress { color: var(--dm-text-primary); }
.diary-tasks-count { /* Original detailed styles restored with theme vars */
    font-size: 0.85em; color: var(--text-secondary); padding: 3px 8px; background-color: rgba(0, 0, 0, 0.08);
    border: 1px solid var(--border-medium); border-radius: 12px; margin-left: 10px;
    transition: background-color var(--transition-speed) var(--transition-func), color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .diary-tasks-count { color: var(--dm-text-secondary); background-color: rgba(255, 255, 255, 0.08); border-color: var(--dm-border-medium); }
.diary-progress-bar-container { /* Original detailed styles restored with theme vars */
    width: 100%; height: 12px; background-color: var(--bg-brown-deep); border-radius: 3px; overflow: hidden;
    border: 1px solid var(--border-dark); box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .diary-progress-bar-container { background-color: var(--dm-bg-darkest); border-color: var(--dm-border-medium); box-shadow: inset 0 1px 2px rgba(0,0,0,0.5); }
.diary-progress-bar { /* Original detailed styles restored with theme vars */
    height: 100%; width: 0%; border-radius: 2px; min-width: 1%;
    transition: width 0.4s ease-out, background-color var(--transition-speed) var(--transition-func);
}
/* Diary colors restored */
.progress-ardougne { background-color: var(--accent-green-muted); } .progress-desert { background-color: var(--accent-gold-dark); } .progress-falador { background-color: var(--accent-blue-muted); } .progress-fremennik { background-color: var(--accent-purple-muted); } .progress-kandarin { background-color: var(--border-medium); } .progress-karamja { background-color: #7f4f24; } .progress-kourend { background-color: var(--accent-grey-muted); } .progress-lumbridge { background-color: var(--accent-red-deep); } .progress-morytania { background-color: var(--accent-indigo-muted); } .progress-varrock { background-color: var(--accent-dark-green); } .progress-western { background-color: var(--accent-yellow-green); } .progress-wilderness { background-color: var(--accent-gold); }
body.dark-mode .progress-ardougne { background-color: var(--dm-accent-green-muted); } body.dark-mode .progress-desert { background-color: var(--dm-accent-gold-dark); } body.dark-mode .progress-falador { background-color: var(--dm-accent-blue-muted); } body.dark-mode .progress-fremennik { background-color: var(--dm-accent-purple-muted); } body.dark-mode .progress-kandarin { background-color: var(--dm-border-light); } body.dark-mode .progress-karamja { background-color: #a0704c; } body.dark-mode .progress-kourend { background-color: var(--dm-accent-grey-muted); } body.dark-mode .progress-lumbridge { background-color: var(--dm-accent-red-deep); } body.dark-mode .progress-morytania { background-color: var(--dm-accent-indigo-muted); } body.dark-mode .progress-varrock { background-color: var(--dm-accent-dark-green); } body.dark-mode .progress-western { background-color: var(--dm-accent-yellow-green); } body.dark-mode .progress-wilderness { background-color: var(--dm-accent-gold); }

/* Diary Content Area */
.diary-content { /* Original detailed styles restored with theme vars */
    padding: 15px; display: none; border-top: 1px solid var(--border-medium); background-color: rgba(0,0,0, 0.02);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
.diary-content.active { display: block; }
body.dark-mode .diary-content { border-top-color: var(--dm-border-medium); background-color: rgba(255,255,255, 0.02); }

/* Difficulty Tabs */
.difficulty-tabs { /* Original styles restored with theme vars */
    display: flex; gap: 8px; margin-bottom: 15px; padding-bottom: 10px;
    border-bottom: 1px solid var(--border-medium); flex-wrap: wrap;
    transition: border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .difficulty-tabs { border-bottom-color: var(--dm-border-medium); }
.diff-button { /* Uses base .filter-button, apply specific styles */
    padding: 5px 12px; font-size: 0.9em; opacity: 0.7;
    /* Background/border/color inherited from .filter-button */
}
.diff-button:hover { opacity: 1; /* Hover effect inherited */ }
.diff-button.active-diff {
    background-color: var(--accent-blue-active); border-color: var(--accent-blue-active);
    color: white; opacity: 1; font-weight: 600; /* Keep standard active blue */
}
body.dark-mode .diff-button.active-diff { background-color: var(--dm-accent-blue-active); border-color: var(--dm-accent-blue-active); color: var(--dm-text-on-light); }


/* Task Category within Diary Content */
.tasks-area { margin-bottom: 15px; }
.task-category { padding-top: 5px; }
.difficulty-header-controls { /* Original styles restored */ display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.difficulty-header-controls h4 { margin-bottom: 0; border-bottom: none; /* Inherits h4 styles */ }
body.dark-mode .difficulty-header-controls h4 { color: var(--dm-text-secondary); } /* Match other subsection headers */
.complete-all-control { /* Original styles restored */ display: flex; align-items: center; gap: 5px; }
.complete-all-control label { /* Original styles restored */ font-size: 0.85em; color: var(--text-secondary); cursor: pointer; user-select: none; }
body.dark-mode .complete-all-control label { color: var(--dm-text-secondary); }
.complete-all-checkbox { /* Original styles restored */ cursor: pointer; width: 15px; height: 15px; accent-color: var(--accent-blue-active); }
body.dark-mode .complete-all-checkbox { accent-color: var(--dm-accent-blue-active); }
.complete-all-checkbox:indeterminate { /* Basic indeterminate styling */ background-color: #777; border-color: #999; }
/* Optional: more complex indeterminate style with pseudo-element (keep if desired) */
.complete-all-checkbox:indeterminate::before { content:''; display:block; width:9px; height:2px; background-color:white; position:relative; top:50%; left:50%; transform:translate(-50%, -50%); }
input[type="checkbox"]:indeterminate { accent-color: grey; background-color: #555; border-color: #777; } /* General indeterminate */


/* Task List & Items */
.tasks { margin-top: 10px; }
/* --- CORE TASK LAYOUT FIX --- */
.task {
    display: flex;
    /* align-items: center; */ /* Changed to baseline for better text alignment */
    align-items: baseline;
    gap: 10px; /* Space between checkbox/handle and main content */
    margin-bottom: 10px; /* Spacing between tasks */
    padding-bottom: 5px; /* Spacing below task */
    position: relative; /* For absolute positioning children like remove button */
}
.task:last-child { margin-bottom: 0; }

/* Checkbox within Task */
.task input[type="checkbox"] {
    margin-top: 0.2em; /* Fine-tune vertical alignment with baseline text */
    flex-shrink: 0;
    width: 16px; height: 16px;
    accent-color: var(--accent-blue-active);
    cursor: pointer;
    transition: accent-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .task input[type="checkbox"] { accent-color: var(--dm-accent-blue-active); }

/* Label/Description Wrapper */
.task label { /* Apply flex to the label itself if it contains multiple spans */
    flex-grow: 1;
    cursor: pointer; /* Make label clickable for checkbox */
}

/* Main Task Description Text */
.task-description {
    /* No display:block needed if label handles layout */
    font-size: 1em;
    line-height: 1.5;
    color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .task-description { color: var(--dm-text-primary); }

/* Inline Task Requirements Text */
.task-requirements {
    display: block; /* Put requirements on new line */
    font-size: 0.85em;
    color: var(--text-secondary);
    /* margin-left: 0; */ /* Indentation handled by label structure */
    margin-top: 2px;
    font-style: italic;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .task-requirements { color: var(--dm-text-secondary); }

/* Completed Task Styling */
.task-completed label, /* Target label for completed tasks */
.task-completed .task-description, /* Keep for direct text elements if any */
.task-completed .task-requirements {
    text-decoration: line-through;
    color: var(--text-secondary);
    opacity: 0.7;
}
body.dark-mode .task-completed label,
body.dark-mode .task-completed .task-description,
body.dark-mode .task-completed .task-requirements {
    color: var(--dm-text-secondary);
}

/* Task Highlighting */
.task.skill-highlight { /* Original styles restored with theme vars */
    background-color: rgba(218, 165, 32, 0.15); border-left: 3px solid var(--accent-gold);
    padding-left: 10px; margin-left: -13px; border-radius: 4px;
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .task.skill-highlight { background-color: rgba(240, 196, 84, 0.15); border-left-color: var(--dm-accent-gold); }

/* Difficulty Progress Bars/Text */
/* Assuming they inherit from .skill-progress-container etc. */
.progress-container {}
.progress-bar {}
.progress-text { font-size: 0.85em; text-align: right; margin-top: 3px; color: var(--text-secondary); transition: color var(--transition-speed) var(--transition-func); }
body.dark-mode .progress-text { color: var(--dm-text-secondary); }
.difficulty-indicator { /* Original styles restored */ display: inline-block; padding: 3px 8px; border-radius: 4px; font-size: 0.8em; margin-left: 10px; color: white; font-weight: 500; text-transform: capitalize; }
/* Difficulty colors restored */
.difficulty-easy .progress-bar, .difficulty-indicator.difficulty-easy { background-color: var(--accent-green-muted); } .difficulty-medium .progress-bar, .difficulty-indicator.difficulty-medium { background-color: var(--accent-gold-dark); } .difficulty-hard .progress-bar, .difficulty-indicator.difficulty-hard { background-color: var(--accent-red-deep); } .difficulty-elite .progress-bar, .difficulty-indicator.difficulty-elite { background-color: var(--accent-indigo-muted); }
body.dark-mode .difficulty-easy .progress-bar, body.dark-mode .difficulty-indicator.difficulty-easy { background-color: var(--dm-accent-green-muted); } body.dark-mode .difficulty-medium .progress-bar, body.dark-mode .difficulty-indicator.difficulty-medium { background-color: var(--dm-accent-gold-dark); } body.dark-mode .difficulty-hard .progress-bar, body.dark-mode .difficulty-indicator.difficulty-hard { background-color: var(--dm-accent-red-deep); } body.dark-mode .difficulty-elite .progress-bar, body.dark-mode .difficulty-indicator.difficulty-elite { background-color: var(--dm-accent-indigo-muted); }

/* Skill Requirements Section (Bottom of Diary Card) */
.skill-requirements-area { margin-top: 15px; }
.skill-requirements { /* Original detailed styles restored with theme vars */
    margin-top: 20px; padding: 15px; background-color: rgba(0,0,0, 0.04); border-radius: 4px;
    border: 1px solid var(--border-medium);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .skill-requirements { background-color: rgba(255,255,255, 0.04); border-color: var(--dm-border-medium); }
.skill-requirements h4 { /* Original styles restored with theme vars */
    margin-bottom: 10px; border: none; padding-bottom: 0; font-size: 1.1em; color: var(--text-primary);
}
body.dark-mode .skill-requirements h4 { color: var(--dm-text-primary); }
.skill-requirement { /* Original detailed styles restored with theme vars */
    display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; padding: 6px 10px;
    background-color: rgba(255,255,255, 0.1); border-radius: 3px; font-size: 0.95em; transition: background-color 0.2s ease; color: var(--text-primary);
}
.skill-requirement:hover { background-color: rgba(255,255,255, 0.2); }
body.dark-mode .skill-requirement { background-color: rgba(0,0,0, 0.1); color: var(--dm-text-primary); }
body.dark-mode .skill-requirement:hover { background-color: rgba(0,0,0, 0.2); }
.skill-met { color: var(--accent-green-muted); font-weight: 600; transition: color var(--transition-speed) var(--transition-func); }
.skill-not-met { color: var(--accent-red-deep); font-weight: 600; transition: color var(--transition-speed) var(--transition-func); }
body.dark-mode .skill-met { color: var(--dm-accent-green-muted); }
body.dark-mode .skill-not-met { color: var(--dm-accent-red-deep); }


/* --- Miscellaneous Goals --- */
/* Inherit header styles from .summary-card .stats-header */
.miscellaneous-goals-container .stats-header {}
.miscellaneous-goals-container .stats-header div {}
.miscellaneous-goals-content { padding: 15px; }
/* Apply .task layout fix here too */
.miscellaneous-goals-content .task { /* Uses shared .task styles */ align-items: baseline; /* Override alignment */ padding-left: 8px; /* Original padding */ }
.drag-handle { /* Original styles restored with theme vars */
    cursor: grab; color: var(--text-secondary); margin-right: 8px; font-size: 16px; display: inline-block; opacity: 0.6;
    transition: opacity 0.2s ease, color var(--transition-speed) var(--transition-func);
}
body.dark-mode .drag-handle { color: var(--dm-text-secondary); }
.draggable-goal:hover .drag-handle { opacity: 1; }
.draggable-goal.task-completed .drag-handle { opacity: 0.4; }
.miscellaneous-goals-content input[type="text"] { /* Original detailed styles restored with theme vars */
    flex-grow: 1; background-color: transparent; border: none; border-bottom: 1px dashed var(--border-medium);
    color: var(--text-primary); padding: 5px 2px; margin-left: 0; /* Overrides checkbox margin */ font: inherit; font-size: 1em; line-height: 1.5;
    transition: border-color var(--transition-speed) var(--transition-func), color var(--transition-speed) var(--transition-func);
}
body.dark-mode .miscellaneous-goals-content input[type="text"] { border-bottom-color: var(--dm-border-medium); color: var(--dm-text-primary); }
.miscellaneous-goals-content input[type="text"]:focus { outline: none; border-bottom: 1px solid var(--text-primary); }
body.dark-mode .miscellaneous-goals-content input[type="text"]:focus { border-bottom-color: var(--dm-text-primary); }
/* Completed state for misc goal input */
.task-completed input[type="text"] {
    text-decoration: line-through; color: var(--text-secondary); border-bottom-color: var(--border-light); opacity: 0.7;
}
body.dark-mode .task-completed input[type="text"] { color: var(--dm-text-secondary); border-bottom-color: var(--dm-border-medium); }
.remove-goal-button { /* Original styles restored with theme vars */
    position: absolute; right: 0; top: 0.7em; /* Adjust vertical alignment */ transform: translateY(0); /* Reset transform */
    background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 1.3em; padding: 0 5px;
    line-height: 1; transition: color 0.2s ease; flex-shrink: 0; /* Prevent shrinking */
}
body.dark-mode .remove-goal-button { color: var(--dm-text-secondary); }
.remove-goal-button:hover { color: var(--accent-red-deep); }
body.dark-mode .remove-goal-button:hover { color: var(--dm-accent-red-deep); }
/* Drag styles restored */
.draggable-goal { min-height: 38px; cursor: grab; position: relative; }
.draggable-goal.dragging { opacity: 0.5; cursor: grabbing; }
.draggable-goal.drag-over { border: 2px dashed var(--accent-gold); background-color: rgba(218, 165, 32, 0.1); transition: border-color var(--transition-speed) var(--transition-func), background-color var(--transition-speed) var(--transition-func); }
body.dark-mode .draggable-goal.drag-over { border-color: var(--dm-accent-gold); background-color: rgba(240, 196, 84, 0.1); }


/* --- Goals & Gear Views --- */
.goals-grid, .gear-stages-grid { /* Original grid styles */ display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; }
.goal-tier-container, .gear-stage-container { /* Inherits .container, flex setup */ display: flex; flex-direction: column; }
.goal-tier-header, .gear-stage-header { /* Original detailed styles restored with theme vars */
    display: flex; align-items: center; gap: 15px; padding-bottom: 15px; margin-bottom: 15px; border-bottom: 1px solid var(--border-medium);
    transition: border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .goal-tier-header, body.dark-mode .gear-stage-header { border-bottom-color: var(--dm-border-medium); }
.goal-tier-header h3, .gear-stage-header h3 { /* Original styles restored with theme vars */
    margin: 0; flex-shrink: 0; color: var(--text-primary); font-size: 1.3em; font-family: var(--font-heading);
}
body.dark-mode .goal-tier-header h3, body.dark-mode .gear-stage-header h3 { color: var(--dm-text-primary); }
#cumulative-goal-tracker .goal-tier-header h3, #cumulative-gear-tracker .goal-tier-header h3 { /* Original styles restored with theme vars */
    color: var(--text-accent); font-size: 1.4em;
}
body.dark-mode #cumulative-goal-tracker .goal-tier-header h3, body.dark-mode #cumulative-gear-tracker .goal-tier-header h3 { color: var(--dm-text-accent); }
.goal-progress-container { /* Original styles restored with theme vars */
    flex-grow: 1; height: 12px; background-color: var(--bg-brown-deep); border-radius: 3px; overflow: hidden;
    border: 1px solid var(--border-dark); box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .goal-progress-container { background-color: var(--dm-bg-darkest); border-color: var(--dm-border-medium); box-shadow: inset 0 1px 2px rgba(0,0,0,0.5); }
.goal-progress-bar { /* Original styles restored with theme vars */ height: 100%; width: 0%; border-radius: 2px; transition: width 0.4s ease-out, background-color var(--transition-speed) var(--transition-func); }
#cumulative-progress-bar { background-color: var(--accent-gold); }
#cumulative-gear-progress-bar { background-color: var(--accent-green-muted); }
body.dark-mode #cumulative-progress-bar { background-color: var(--dm-accent-gold); }
body.dark-mode #cumulative-gear-progress-bar { background-color: var(--dm-accent-green-muted); }
.goal-percentage { /* Original styles restored with theme vars */
    font-weight: 600; font-size: 1em; width: 40px; text-align: right; flex-shrink: 0; color: var(--text-primary);
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .goal-percentage { color: var(--dm-text-primary); }

/* Scrollable Lists */
.goal-list, .gear-item-list { /* Original detailed styles restored with theme vars */
    max-height: 400px; overflow-y: auto; padding-right: 10px;
    scrollbar-width: thin; scrollbar-color: var(--bg-tan-medium) var(--bg-brown-deep);
    transition: scrollbar-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .goal-list, body.dark-mode .gear-item-list { scrollbar-color: var(--dm-bg-medium) var(--dm-bg-darkest); }
.goal-list::-webkit-scrollbar, .gear-item-list::-webkit-scrollbar { width: 10px; }
.goal-list::-webkit-scrollbar-track, .gear-item-list::-webkit-scrollbar-track { background: var(--bg-brown-deep); border-radius: 5px; transition: background-color var(--transition-speed) var(--transition-func); }
body.dark-mode .goal-list::-webkit-scrollbar-track, body.dark-mode .gear-item-list::-webkit-scrollbar-track { background: var(--dm-bg-darkest); }
.goal-list::-webkit-scrollbar-thumb, .gear-item-list::-webkit-scrollbar-thumb { background-color: var(--bg-tan-medium); border-radius: 5px; border: 2px solid var(--bg-brown-deep); transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func); }
body.dark-mode .goal-list::-webkit-scrollbar-thumb, body.dark-mode .gear-item-list::-webkit-scrollbar-thumb { background-color: var(--dm-bg-medium); border-color: var(--dm-bg-darkest); }
.goal-list::-webkit-scrollbar-thumb:hover, .gear-item-list::-webkit-scrollbar-thumb:hover { background-color: var(--bg-tan-light); }
body.dark-mode .goal-list::-webkit-scrollbar-thumb:hover, body.dark-mode .gear-item-list::-webkit-scrollbar-thumb:hover { background-color: var(--dm-bg-light); }

/* List Items */
.goal-list .task { /* Uses shared .task styles */ padding: 8px 5px; margin-bottom: 5px; }
.goal-info { /* Original styles restored with theme vars */
    margin-left: auto; color: var(--text-secondary); font-size: 0.95em; padding-left: 10px; text-align: right; flex-shrink: 0;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .goal-info { color: var(--dm-text-secondary); }
.gear-item { /* Uses shared .task styles */ padding: 6px 5px; margin-bottom: 4px; }
.gear-item label { /* Flex applied via .task label rules */ margin-right: 10px; } /* Keep margin */
.item-price { /* Original styles restored with theme vars */
    font-size: 0.85em; color: var(--text-secondary); margin-left: 8px; font-style: italic;
    transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .item-price { color: var(--dm-text-secondary); }
.stage-cost { /* Original styles restored with theme vars */
    font-size: 0.9em; color: var(--accent-gold-dark); font-weight: 600; margin-left: auto; padding-left: 15px;
    white-space: nowrap; transition: color var(--transition-speed) var(--transition-func);
}
body.dark-mode .stage-cost { color: var(--dm-accent-gold); }
.gear-style-icon { /* Original detailed styles restored with theme vars */
    width: 20px; height: 20px; margin-left: 10px; /* Use margin, not auto if label grows */ flex-shrink: 0;
    object-fit: contain; vertical-align: middle; filter: sepia(30%) brightness(0.9);
    transition: filter var(--transition-speed) var(--transition-func), opacity var(--transition-speed) var(--transition-func);
}
body.dark-mode .gear-style-icon { filter: brightness(1.1); }
.gear-item.task-completed .gear-style-icon { opacity: 0.5; filter: grayscale(80%) opacity(0.5); }
body.dark-mode .gear-item.task-completed .gear-style-icon { opacity: 0.6; filter: grayscale(60%) opacity(0.6); }

/* --- Buttons --- */
/* Base button styles restored */
button, .filter-button {
    background-color: var(--bg-tan-medium); color: var(--text-primary); border: 2px solid var(--border-dark);
    padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 0.95em;
    text-shadow: 1px 1px 1px rgba(255,255,255,0.1); box-shadow: 1px 1px 3px rgba(0,0,0,0.2);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func), color var(--transition-speed) var(--transition-func), box-shadow var(--transition-speed) var(--transition-func), opacity var(--transition-speed) var(--transition-func);
}
button:hover, .filter-button:hover {
    background-color: var(--bg-tan-light); border-color: var(--border-medium); box-shadow: 2px 2px 5px rgba(0,0,0,0.25);
}
/* Sort/Active Button Style */
.filter-button.active {
    background-color: var(--accent-gold); border-color: var(--accent-gold-dark); color: var(--bg-brown-deep);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3), 1px 1px 3px rgba(0,0,0,0.1);
}
button:disabled, .filter-button:disabled { opacity: 0.6; cursor: not-allowed; box-shadow: none; }
/* Save Button Style */
.save-button {
    background-color: var(--accent-green-muted); border-color: #405a21; color: var(--text-on-dark);
    margin-top: 20px; width: 100%; padding: 10px 15px; font-size: 1.1em; font-family: var(--font-heading);
}
.save-button:hover { background-color: #6b8e23; border-color: #556b2f; }

/* Dark Mode Buttons */
body.dark-mode button, body.dark-mode .filter-button {
    background-color: var(--dm-bg-medium); color: var(--dm-text-primary); border: 2px solid var(--dm-border-light);
    text-shadow: 1px 1px 1px rgba(0,0,0,0.2); box-shadow: 1px 1px 3px rgba(0,0,0,0.4);
}
body.dark-mode button:hover, body.dark-mode .filter-button:hover {
    background-color: var(--dm-bg-light); border-color: var(--dm-border-light); box-shadow: 2px 2px 5px rgba(0,0,0,0.5);
}
body.dark-mode .filter-button.active {
    background-color: var(--dm-accent-gold); border-color: var(--dm-accent-gold-dark); color: var(--dm-text-on-light);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5), 1px 1px 3px rgba(0,0,0,0.3);
}
body.dark-mode button:disabled, body.dark-mode .filter-button:disabled { opacity: 0.6; cursor: not-allowed; box-shadow: none; }
body.dark-mode .save-button {
    background-color: var(--dm-accent-green-muted); border-color: #7aaa7a; color: var(--dm-text-on-light);
}
body.dark-mode .save-button:hover { background-color: #a8d1a8; border-color: #8fbc8f; }


/* --- Modal Styles --- */
/* Original styles restored with theme vars */
.modal {
    display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto;
    background-color: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
}
.modal-content { /* Uses .container styles */
    margin: 8% auto; padding: 25px; width: 85%; max-width: 700px;
    /* Apply theme variables for background/border */
    background-color: var(--bg-parchment); border: 2px solid var(--border-dark);
    color: var(--text-primary);
}
body.dark-mode .modal-content { background-color: var(--dm-bg-dark); border-color: var(--dm-border-light); color: var(--dm-text-primary); }
.modal-close { /* Original styles restored with theme vars */
    color: var(--text-secondary); float: right; font-size: 32px; font-weight: bold; cursor: pointer; line-height: 0.8; transition: color 0.2s ease;
}
body.dark-mode .modal-close { color: var(--dm-text-secondary); }
.modal-close:hover { color: var(--text-primary); }
body.dark-mode .modal-close:hover { color: var(--dm-text-primary); }
.skill-editor { /* Original styles restored */ display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 15px; margin: 25px 0; }
.skill-editor-item { /* Original detailed styles restored with theme vars */
    display: flex; align-items: center; gap: 10px; background-color: rgba(0,0,0, 0.04); padding: 12px 15px; border-radius: 4px; border: 1px solid var(--border-medium);
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func);
}
body.dark-mode .skill-editor-item { background-color: rgba(255,255,255, 0.04); border-color: var(--dm-border-medium); }
.skill-editor-item label { flex-shrink: 0; width: 95px; font-weight: 500; text-align: right; margin-right: 5px; }
.skill-editor-item input { /* Original detailed styles restored with theme vars */
    width: 60px; padding: 8px; background-color: var(--bg-parchment); border: 1px solid var(--border-dark); border-radius: 5px;
    color: var(--text-primary); text-align: center; font-weight: 600;
    transition: background-color var(--transition-speed) var(--transition-func), border-color var(--transition-speed) var(--transition-func), color var(--transition-speed) var(--transition-func);
}
body.dark-mode .skill-editor-item input { background-color: var(--dm-bg-darkest); border-color: var(--dm-border-medium); color: var(--dm-text-primary); }
.rate-section { display: flex; align-items: center; gap: 8px; margin-left: auto; }
.skill-editor-rate-input { width: 80px !important; font-size: 0.9em; border: 1px solid var(--border-dark) !important; margin: 0; } /* Inherits input styles */
.skill-editor-item label.rate-label { width: auto !important; text-align: left; margin: 0; padding: 0; color: var(--text-secondary); font-size: 0.85em; flex-shrink: 0; }
body.dark-mode .skill-editor-item label.rate-label { color: var(--dm-text-secondary); }
.modal-actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 25px; }


/* --- Tooltips --- */
/* Original styles restored with theme vars */
.tooltip { position: relative; display: inline-block; cursor: help; }
.tooltip .tooltiptext {
    visibility: hidden; width: 220px; background-color: var(--bg-brown-dark); color: var(--text-on-dark); text-align: center;
    border-radius: 6px; padding: 8px; position: absolute; z-index: 10; bottom: 130%; left: 50%; margin-left: -110px;
    opacity: 0; transition: opacity 0.3s ease, visibility 0.3s ease; font-size: 0.9em; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}
body.dark-mode .tooltip .tooltiptext { background-color: var(--dm-bg-light); color: var(--dm-text-primary); }
.tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }